{"last_node_id":73,"last_link_id":125,"nodes":[{"id":28,"type":"IPAdapterEmbeds","pos":[1100,-250],"size":{"0":315,"1":254},"flags":{"pinned":true},"order":20,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":49},{"name":"ipadapter","type":"IPADAPTER","link":46},{"name":"pos_embed","type":"EMBEDS","link":45},{"name":"neg_embed","type":"EMBEDS","link":null},{"name":"attn_mask","type":"MASK","link":null},{"name":"clip_vision","type":"CLIP_VISION","link":47}],"outputs":[{"name":"MODEL","type":"MODEL","links":[48],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"IPAdapterEmbeds"},"widgets_values":[0.8,"linear",0,1,"V only"]},{"id":10,"type":"EmptyLatentImage","pos":[834,567],"size":{"0":210,"1":110},"flags":{},"order":0,"mode":0,"outputs":[{"name":"LATENT","type":"LATENT","links":[10],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"EmptyLatentImage"},"widgets_values":[768,1280,1]},{"id":3,"type":"IPAdapterModelLoader","pos":[-17,-162],"size":{"0":321.09210205078125,"1":58},"flags":{},"order":1,"mode":0,"outputs":[{"name":"IPADAPTER","type":"IPADAPTER","links":[46,50,51],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"IPAdapterModelLoader"},"widgets_values":["ip-adapter_sdxl.safetensors"]},{"id":31,"type":"IPAdapterEncoder","pos":[605,-30],"size":{"0":210,"1":118},"flags":{},"order":18,"mode":0,"inputs":[{"name":"ipadapter","type":"IPADAPTER","link":51},{"name":"image","type":"IMAGE","link":42},{"name":"mask","type":"MASK","link":null},{"name":"clip_vision","type":"CLIP_VISION","link":54}],"outputs":[{"name":"pos_embed","type":"EMBEDS","links":[44],"shape":3,"slot_index":0},{"name":"neg_embed","type":"EMBEDS","links":null,"shape":3}],"properties":{"Node name for S&R":"IPAdapterEncoder"},"widgets_values":[1]},{"id":6,"type":"LoadImage","pos":[599,-406],"size":{"0":220,"1":320},"flags":{},"order":2,"mode":0,"outputs":[{"name":"IMAGE","type":"IMAGE","links":[42],"shape":3,"slot_index":0},{"name":"MASK","type":"MASK","links":null,"shape":3}],"properties":{"Node name for S&R":"LoadImage"},"widgets_values":["mrkent7_A_perfectly_composed_shot_of_a_faceless_robot_wearing_a_3432da89-cc10-4cce-852f-b9030085535f (1)-2.png","image"]},{"id":41,"type":"KSampler","pos":[2126.4410810546883,-700.1590457031251],"size":{"0":315,"1":262},"flags":{},"order":27,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":112},{"name":"positive","type":"CONDITIONING","link":69},{"name":"negative","type":"CONDITIONING","link":70},{"name":"latent_image","type":"LATENT","link":95}],"outputs":[{"name":"LATENT","type":"LATENT","links":[97],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"KSampler"},"widgets_values":[929541525622583,"randomize",10,6,"dpmpp_2m","karras",0.4]},{"id":43,"type":"Reroute","pos":[1910,-302],"size":[75,26],"flags":{},"order":16,"mode":0,"inputs":[{"name":"","type":"*","link":80}],"outputs":[{"name":"","type":"VAE","links":[93,98,115],"slot_index":0}],"properties":{"showOutputText":false,"horizontal":false}},{"id":64,"type":"SAMLoader","pos":[1744.0217947158633,895.2054076398817],"size":{"0":315,"1":82},"flags":{},"order":3,"mode":0,"outputs":[{"name":"SAM_MODEL","type":"SAM_MODEL","links":[107],"shape":3}],"properties":{"Node name for S&R":"SAMLoader"},"widgets_values":["sam_vit_b_01ec64.pth","AUTO"],"color":"#223","bgcolor":"#335"},{"id":65,"type":"Reroute","pos":[1187,-340],"size":[75,26],"flags":{},"order":13,"mode":0,"inputs":[{"name":"","type":"*","link":111}],"outputs":[{"name":"","type":"MODEL","links":[112,113],"slot_index":0}],"properties":{"showOutputText":false,"horizontal":false}},{"id":8,"type":"CLIPTextEncode","pos":[452,406],"size":{"0":575.5219116210938,"1":114.71165466308594},"flags":{},"order":15,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":6}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[9,70,117],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":["(low quality, worst quality),Deformed,bad quality,grainy,noisy,plastic,hazy,low contrast,bad hands,text,watermark,bad,ugly,blurry,"],"color":"#322","bgcolor":"#533"},{"id":9,"type":"KSampler","pos":[1100,150],"size":{"0":315,"1":262},"flags":{},"order":21,"mode":0,"inputs":[{"name":"model","type":"MODEL","link":48},{"name":"positive","type":"CONDITIONING","link":8},{"name":"negative","type":"CONDITIONING","link":9},{"name":"latent_image","type":"LATENT","link":10}],"outputs":[{"name":"LATENT","type":"LATENT","links":[11],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"KSampler"},"widgets_values":[37563458278617,"randomize",30,6,"dpmpp_2m","karras",1]},{"id":63,"type":"UltralyticsDetectorProvider","pos":[1746.0217947158633,775.205407639882],"size":{"0":315,"1":78},"flags":{},"order":4,"mode":0,"outputs":[{"name":"BBOX_DETECTOR","type":"BBOX_DETECTOR","links":[106],"shape":3,"slot_index":0},{"name":"SEGM_DETECTOR","type":"SEGM_DETECTOR","links":[108],"shape":3,"slot_index":1}],"properties":{"Node name for S&R":"UltralyticsDetectorProvider"},"widgets_values":["bbox/face_yolov8m.pt"],"color":"#223","bgcolor":"#335"},{"id":30,"type":"IPAdapterEncoder","pos":[369,-32],"size":{"0":210,"1":118},"flags":{},"order":17,"mode":0,"inputs":[{"name":"ipadapter","type":"IPADAPTER","link":50},{"name":"image","type":"IMAGE","link":41},{"name":"mask","type":"MASK","link":null},{"name":"clip_vision","type":"CLIP_VISION","link":53}],"outputs":[{"name":"pos_embed","type":"EMBEDS","links":[43],"shape":3,"slot_index":0},{"name":"neg_embed","type":"EMBEDS","links":null,"shape":3}],"properties":{"Node name for S&R":"IPAdapterEncoder"},"widgets_values":[1]},{"id":15,"type":"LoadImage","pos":[356,-402],"size":{"0":220,"1":320},"flags":{},"order":5,"mode":0,"outputs":[{"name":"IMAGE","type":"IMAGE","links":[41],"shape":3,"slot_index":0},{"name":"MASK","type":"MASK","links":null,"shape":3}],"properties":{"Node name for S&R":"LoadImage"},"widgets_values":["mrkent7_Depicted_in_cartoon_illustration_style_of_a_man_surro_d8dac4ca-6f0e-4171-9a15-c87e47b12e9a_1 - 副本.png","image"]},{"id":11,"type":"VAEDecode","pos":[1454,-252],"size":{"0":140,"1":50},"flags":{},"order":22,"mode":0,"inputs":[{"name":"samples","type":"LATENT","link":11},{"name":"vae","type":"VAE","link":39}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[92,122],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"VAEDecode"}},{"id":69,"type":"SaveImage","pos":[1452,-153],"size":[503.45943511389805,642.4037947377055],"flags":{},"order":24,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":122}],"properties":{},"widgets_values":["IPAdapter"]},{"id":2,"type":"VAELoader","pos":[1110,460],"size":{"0":300,"1":60},"flags":{},"order":6,"mode":0,"outputs":[{"name":"VAE","type":"VAE","links":[],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"VAELoader"},"widgets_values":["sdxl_vae-fp16-fix.safetensors"]},{"id":1,"type":"CheckpointLoaderSimple","pos":[-18,232],"size":[395.6521659959002,98.72216680290569],"flags":{},"order":7,"mode":0,"outputs":[{"name":"MODEL","type":"MODEL","links":[49,111],"shape":3,"slot_index":0},{"name":"CLIP","type":"CLIP","links":[5,6,114],"shape":3,"slot_index":1},{"name":"VAE","type":"VAE","links":[39,80],"shape":3,"slot_index":2}],"properties":{"Node name for S&R":"CheckpointLoaderSimple"},"widgets_values":["Dream Tech XL _ 筑梦工业XL_v5.0 - 与光同尘.safetensors"]},{"id":29,"type":"IPAdapterCombineEmbeds","pos":[851,-241],"size":{"0":210,"1":171.0482940673828},"flags":{},"order":19,"mode":0,"inputs":[{"name":"embed1","type":"EMBEDS","link":43},{"name":"embed2","type":"EMBEDS","link":44},{"name":"embed3","type":"EMBEDS","link":null},{"name":"embed4","type":"EMBEDS","link":null},{"name":"embed5","type":"EMBEDS","link":null}],"outputs":[{"name":"EMBEDS","type":"EMBEDS","links":[45],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"IPAdapterCombineEmbeds"},"widgets_values":["average"]},{"id":37,"type":"ImageUpscaleWithModel","pos":[1284,-578],"size":{"0":241.79998779296875,"1":46},"flags":{},"order":23,"mode":0,"inputs":[{"name":"upscale_model","type":"UPSCALE_MODEL","link":59},{"name":"image","type":"IMAGE","link":92,"slot_index":1}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[120],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"ImageUpscaleWithModel"}},{"id":70,"type":"ImageScale","pos":[1541,-583],"size":{"0":315,"1":130},"flags":{},"order":25,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":120}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[121],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"ImageScale"},"widgets_values":["nearest-exact",960,1600,"disabled"]},{"id":36,"type":"UpscaleModelLoader","pos":[946,-580],"size":{"0":315,"1":58},"flags":{},"order":8,"mode":0,"outputs":[{"name":"UPSCALE_MODEL","type":"UPSCALE_MODEL","links":[59],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"UpscaleModelLoader"},"widgets_values":["4x-UltraSharp.pth"]},{"id":38,"type":"VAEEncode","pos":[1878,-577],"size":{"0":210,"1":46},"flags":{},"order":26,"mode":0,"inputs":[{"name":"pixels","type":"IMAGE","link":121},{"name":"vae","type":"VAE","link":93,"slot_index":1}],"outputs":[{"name":"LATENT","type":"LATENT","links":[95],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"VAEEncode"}},{"id":72,"type":"Note","pos":[355,-612],"size":[470.12525882317334,158.49244866654146],"flags":{},"order":9,"mode":0,"properties":{"text":""},"widgets_values":["注意：图片下面的IPAdapter Encoder可以分别调整参考图片的权重，可以根据自己需求调整权重和增减图片。\n右侧IPAdapter Embeds有总的权重，建议设置0.8左右。\n"],"color":"#432","bgcolor":"#653"},{"id":35,"type":"VAEDecode","pos":[2476.4410810546883,-610.1590457031251],"size":{"0":210,"1":46},"flags":{},"order":28,"mode":0,"inputs":[{"name":"samples","type":"LATENT","link":97,"slot_index":0},{"name":"vae","type":"VAE","link":98}],"outputs":[{"name":"IMAGE","type":"IMAGE","links":[96,124],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"VAEDecode"}},{"id":59,"type":"FaceDetailer","pos":[2118.876588281248,623.5231746093752],"size":{"0":361.3311767578125,"1":906.4287109375},"flags":{"pinned":false},"order":30,"mode":0,"inputs":[{"name":"image","type":"IMAGE","link":124},{"name":"model","type":"MODEL","link":113},{"name":"clip","type":"CLIP","link":114},{"name":"vae","type":"VAE","link":115,"slot_index":3},{"name":"positive","type":"CONDITIONING","link":116},{"name":"negative","type":"CONDITIONING","link":117},{"name":"bbox_detector","type":"BBOX_DETECTOR","link":106,"slot_index":6},{"name":"sam_model_opt","type":"SAM_MODEL","link":107,"slot_index":7},{"name":"segm_detector_opt","type":"SEGM_DETECTOR","link":108,"slot_index":8},{"name":"detailer_hook","type":"DETAILER_HOOK","link":null}],"outputs":[{"name":"image","type":"IMAGE","links":[125],"shape":3,"slot_index":0},{"name":"cropped_refined","type":"IMAGE","links":null,"shape":6},{"name":"cropped_enhanced_alpha","type":"IMAGE","links":null,"shape":6},{"name":"mask","type":"MASK","links":[],"shape":3,"slot_index":3},{"name":"detailer_pipe","type":"DETAILER_PIPE","links":null,"shape":3},{"name":"cnet_images","type":"IMAGE","links":null,"shape":6}],"properties":{"Node name for S&R":"FaceDetailer"},"widgets_values":[384,true,1024,643594445402674,"randomize",20,4,"euler_ancestral","normal",0.5,5,true,true,0.5,10,3,"center-1",0,0.93,0,0.7,"False",10,"",1,false,0],"color":"#223","bgcolor":"#335"},{"id":73,"type":"Note","pos":[355,-824],"size":{"0":470.125244140625,"1":158.49244689941406},"flags":{},"order":10,"mode":0,"properties":{"text":""},"widgets_values":["IPAdapter+高清修复upscale+修脸FaceDetailer，\n注意：第一次运行加载CLIP和大模型，需要等待一下，后面基本流畅运行。"],"color":"#323","bgcolor":"#535"},{"id":4,"type":"CLIPVisionLoader","pos":[1,-276],"size":{"0":300,"1":60},"flags":{},"order":11,"mode":0,"outputs":[{"name":"CLIP_VISION","type":"CLIP_VISION","links":[47,53,54],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"CLIPVisionLoader"},"widgets_values":["clip_vision_g.safetensors"]},{"id":7,"type":"CLIPTextEncode","pos":[466,151],"size":{"0":567.4710083007812,"1":209.03265380859375},"flags":{},"order":14,"mode":0,"inputs":[{"name":"clip","type":"CLIP","link":5}],"outputs":[{"name":"CONDITIONING","type":"CONDITIONING","links":[8,69,116],"shape":3,"slot_index":0}],"properties":{"Node name for S&R":"CLIPTextEncode"},"widgets_values":["a beautiful long hair girl,long dress，full body shot,solo,chinese style,details,looking at viewer,Concept Fashion,\nhighly detailed, ultra-high resolutions, "],"color":"#232","bgcolor":"#353"},{"id":62,"type":"SaveImage","pos":[2626,-154],"size":{"0":531.2354125976562,"1":656.4398193359375},"flags":{},"order":31,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":125}],"properties":{},"widgets_values":["IPAdapter+upscale+FaceDetailer"]},{"id":40,"type":"SaveImage","pos":[2025,-159],"size":{"0":525.1979370117188,"1":661.4398193359375},"flags":{},"order":29,"mode":0,"inputs":[{"name":"images","type":"IMAGE","link":96}],"properties":{},"widgets_values":["IPAdapter+upscale"]},{"id":71,"type":"Note","pos":[1453,-698],"size":[525.6250021158082,75.2455512187064],"flags":{},"order":12,"mode":0,"properties":{"text":""},"widgets_values":["注意：这里的调整放大的图片尺寸，最好是前面尺寸的1.5-2倍。不要太大，否则显存不够会卡住。"],"color":"#432","bgcolor":"#653"}],"links":[[5,1,1,7,0,"CLIP"],[6,1,1,8,0,"CLIP"],[8,7,0,9,1,"CONDITIONING"],[9,8,0,9,2,"CONDITIONING"],[10,10,0,9,3,"LATENT"],[11,9,0,11,0,"LATENT"],[39,1,2,11,1,"VAE"],[41,15,0,30,1,"IMAGE"],[42,6,0,31,1,"IMAGE"],[43,30,0,29,0,"EMBEDS"],[44,31,0,29,1,"EMBEDS"],[45,29,0,28,2,"EMBEDS"],[46,3,0,28,1,"IPADAPTER"],[47,4,0,28,5,"CLIP_VISION"],[48,28,0,9,0,"MODEL"],[49,1,0,28,0,"MODEL"],[50,3,0,30,0,"IPADAPTER"],[51,3,0,31,0,"IPADAPTER"],[53,4,0,30,3,"CLIP_VISION"],[54,4,0,31,3,"CLIP_VISION"],[59,36,0,37,0,"UPSCALE_MODEL"],[69,7,0,41,1,"CONDITIONING"],[70,8,0,41,2,"CONDITIONING"],[80,1,2,43,0,"*"],[92,11,0,37,1,"IMAGE"],[93,43,0,38,1,"VAE"],[95,38,0,41,3,"LATENT"],[96,35,0,40,0,"IMAGE"],[97,41,0,35,0,"LATENT"],[98,43,0,35,1,"VAE"],[106,63,0,59,6,"BBOX_DETECTOR"],[107,64,0,59,7,"SAM_MODEL"],[108,63,1,59,8,"SEGM_DETECTOR"],[111,1,0,65,0,"*"],[112,65,0,41,0,"MODEL"],[113,65,0,59,1,"MODEL"],[114,1,1,59,2,"CLIP"],[115,43,0,59,3,"VAE"],[116,7,0,59,4,"CONDITIONING"],[117,8,0,59,5,"CONDITIONING"],[120,37,0,70,0,"IMAGE"],[121,70,0,38,0,"IMAGE"],[122,11,0,69,0,"IMAGE"],[124,35,0,59,0,"IMAGE"],[125,59,0,62,0,"IMAGE"]],"groups":[{"title":"Upscale 高清修复","bounding":[880,-792,1883,395],"color":"#3f789e","font_size":24},{"title":"FaceDetailer 修脸","bounding":[1725,540,1530,1004],"color":"#3f789e","font_size":24}],"config":{},"extra":{"workspace_info":{"id":"V1WSvNWp4pI5LkX4_rwXS"},"ds":{"scale":0.826446280991736,"offset":[-407.08803847739534,878.4901355250978]}},"version":0.4}